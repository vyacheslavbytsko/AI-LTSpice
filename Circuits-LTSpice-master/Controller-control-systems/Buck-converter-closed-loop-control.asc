Version 4
SHEET 1 1948 680
WIRE 624 -320 624 -400
WIRE 944 -320 944 -416
WIRE 1344 -304 1344 -400
WIRE 624 -224 624 -240
WIRE 944 -208 944 -240
WIRE 1344 -192 1344 -224
WIRE 448 -112 -80 -112
WIRE 448 -64 448 -112
WIRE 384 -48 272 -48
WIRE 272 -16 272 -48
WIRE -80 16 -80 -112
WIRE 384 16 384 -48
WIRE 400 16 384 16
WIRE 272 96 272 64
WIRE 448 96 448 32
WIRE 448 96 272 96
WIRE 576 96 448 96
WIRE 768 96 656 96
WIRE 928 96 768 96
WIRE 448 128 448 96
WIRE 768 128 768 96
WIRE 928 128 928 96
WIRE -80 240 -80 96
WIRE 448 240 448 192
WIRE 448 240 -80 240
WIRE 768 240 768 192
WIRE 768 240 448 240
WIRE 928 240 928 208
WIRE 928 240 768 240
WIRE -80 288 -80 240
FLAG -80 288 0
FLAG 624 -224 0
FLAG 944 -208 0
FLAG 1344 -192 0
FLAG 624 -400 error
FLAG 944 -416 PI_out
FLAG 1344 -400 PI_sat
FLAG 928 96 Vout
SYMBOL voltage -80 0 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 20
SYMBOL ind 672 80 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName L1
SYMATTR Value 47µ
SYMBOL schottky 464 192 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap 752 128 R0
SYMATTR InstName C1
SYMATTR Value 100µ
SYMBOL res 912 112 R0
SYMATTR InstName R1
SYMATTR Value R=IF(time < 5m, 1, 2)
SYMBOL nmos 400 -64 R0
SYMATTR InstName M1
SYMATTR Value BSB012N03LX3
SYMBOL bv 624 -336 R0
SYMATTR InstName Vb1
SYMATTR Value V= {y_ref}-V(Vout)
SYMBOL bv 944 -336 R0
SYMATTR InstName PI_regulator
SYMATTR Value V= 5*V(error) + 500*idt(V(error))
SYMBOL bv 1344 -320 R0
SYMATTR InstName PI_regulator1
SYMATTR Value V= IF(V(PI_out) > 0, min(V(PI_out), 1), 0)
SYMBOL bv 272 -32 R0
WINDOW 3 171 294 Left 2
SYMATTR InstName B1
SYMATTR Value V=IF(time - floor(time/Ts)*Ts < V(PI_sat)*Ts, 20, 0)
TEXT -74 344 Left 2 !.tran 10m startup
TEXT -40 -264 Left 2 !.param y_ref=10
TEXT -32 -208 Left 2 !.param Ts 10u
